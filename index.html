<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>VR Cardboard - Menu emojis arrondi + sc√®ne cam</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
</head>
<body style="margin: 0;">
  <a-scene vr-mode-ui="enabled: true">
    <!-- Cam√©ra + curseur -->
    <a-entity id="cameraRig" camera look-controls position="0 1.6 0" fov="45">
      <a-entity
        id="cursor"
        cursor="rayOrigin: entity"
        raycaster="objects: .clickable"
        position="0 0 -1"
        geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
        material="color: white; shader: flat"
      ></a-entity>
    </a-entity>

    <!-- Fond panoramique -->
    <a-sky id="sky" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/sechelt.jpg"></a-sky>

    <!-- Cube -->
    <a-box id="box" position="0 1.6 -3" color="#A0CED9"></a-box>

    <!-- Menu emojis petit avec coins arrondis -->
    <a-entity id="menu" position="0 1.15 -1.2">
      <!-- Bouton 1 -->
      <a-circle
        id="scene1"
        class="clickable"
        radius="0.15"
        color="#ECECEC"
        position="-0.5 0 0"
        material="shader: flat"
        event-set__enter="_event: mouseenter; color: #DADADA"
        event-set__leave="_event: mouseleave; color: #ECECEC"
      >
        <a-text value="üåÖ" align="center" color="black" position="0 0 0.01" width="2"></a-text>
      </a-circle>

      <!-- Bouton 2 -->
      <a-circle
        id="scene2"
        class="clickable"
        radius="0.15"
        color="#ECECEC"
        position="0 0 0"
        material="shader: flat"
        event-set__enter="_event: mouseenter; color: #DADADA"
        event-set__leave="_event: mouseleave; color: #ECECEC"
      >
        <a-text value="üèûÔ∏è" align="center" color="black" position="0 0 0.01" width="2"></a-text>
      </a-circle>

      <!-- Bouton 3 -->
      <a-circle
        id="scene3"
        class="clickable"
        radius="0.15"
        color="#ECECEC"
        position="0.5 0 0"
        material="shader: flat"
        event-set__enter="_event: mouseenter; color: #DADADA"
        event-set__leave="_event: mouseleave; color: #ECECEC"
      >
        <a-text value="üé•" align="center" color="black" position="0 0 0.01" width="2"></a-text>
      </a-circle>
    </a-entity>
  </a-scene>

  <script>
    // Activer capteurs (iOS)
    window.addEventListener("click", function () {
      if (
        typeof DeviceOrientationEvent !== "undefined" &&
        typeof DeviceOrientationEvent.requestPermission === "function"
      ) {
        DeviceOrientationEvent.requestPermission()
          .then((response) => {
            if (response === "granted") console.log("Orientation activ√©e");
            else alert("Permission capteur refus√©e");
          })
          .catch(console.error);
      }
    });

    // Clic √©cran = clique sur objet point√© par curseur
    document.addEventListener("click", () => {
      const cursor = document.querySelector("#cursor");
      const intersections = cursor.components.raycaster.intersections;

      if (intersections.length > 0) {
        const target = intersections[0].object.el;
        if (target && target.classList.contains("clickable")) {
          target.emit("click");
        }
      }
    });

    // √âcouteurs clics menu
    document.addEventListener("DOMContentLoaded", function () {
      document.querySelector("#scene1").addEventListener("click", () => changeScene(1));
      document.querySelector("#scene2").addEventListener("click", () => changeScene(2));
      document.querySelector("#scene3").addEventListener("click", () => changeScene(3));
    });

    // Fonction changement sc√®ne
    function changeScene(id) {
      const sky = document.querySelector("#sky");
      const box = document.querySelector("#box");
      const cameraRig = document.querySelector("#cameraRig");

      if (id === 1) {
        // Sc√®ne 1: panorama + cube bleu clair
        sky.setAttribute("src", "https://cdn.aframe.io/360-image-gallery-boilerplate/img/sechelt.jpg");
        box.setAttribute("color", "#A0CED9");
        box.setAttribute("visible", true);
        cameraRig.setAttribute("position", "0 1.6 0");
        cameraRig.setAttribute("camera", "fov: 80"); // champ de vue normal VR
      } else if (id === 2) {
        // Sc√®ne 2: autre panorama + cube rouge
        sky.setAttribute("src", "https://raw.githubusercontent.com/aframevr/360-image-gallery/master/images/360.jpg");
        box.setAttribute("color", "#D65F5F");
        box.setAttribute("visible", true);
        cameraRig.setAttribute("position", "0 1.6 0");
        cameraRig.setAttribute("camera", "fov: 80"); // champ de vue normal VR
      } else if (id === 3) {
        // Sc√®ne 3: "Pas de casque VR" = juste la cam√©ra zoom√©e + fond noir
        sky.setAttribute("color", "#000000"); // fond noir uni, sans texture
        sky.removeAttribute("src");
        box.setAttribute("visible", false);
        cameraRig.setAttribute("position", "0 1.6 0.5"); // avancer cam√©ra un peu vers l'avant
        cameraRig.setAttribute("camera", "fov: 30"); // champ de vue zoom√© pour simuler √©cran normal
      }
    }
  </script>
</body>
</html>
